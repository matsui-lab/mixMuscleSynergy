% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/best_fit.R
\name{select_optimal_K_r_mfa}
\alias{select_optimal_K_r_mfa}
\title{Search for the Best (K, r) for MFA via Grid Search (Using mfa_em_fit)}
\usage{
select_optimal_K_r_mfa(
  list_of_data,
  Kvec = 1:5,
  rvec = 1:5,
  max_iter = 50,
  nIterFA = 5,
  tol = 0.001,
  n_init = 1,
  use_kmeans_init = TRUE,
  subject_rdim_for_kmeans = 2
)
}
\arguments{
\item{list_of_data}{A list of data matrices, each (T_i x M).}

\item{Kvec}{An integer vector of candidate K values.}

\item{rvec}{An integer vector of candidate r values.}

\item{max_iter}{Maximum EM iterations.}

\item{nIterFA}{Sub-iterations within the factor-analyzer update in C++.}

\item{tol}{Convergence tolerance.}

\item{n_init}{Number of random initializations to try inside mfa_em_fit.}

\item{use_kmeans_init}{Logical; whether to also try a k-means-based init.}

\item{subject_rdim_for_kmeans}{Dimension for PCA-based features if use_kmeans_init=TRUE.}
}
\value{
A list with:
  \item{summary}{A data.frame with columns K, r, logLik, BIC.}
  \item{best_model_info}{A list with (K, r, model, logLik, BIC) for the best BIC.}
  \item{all_models}{A list of all fits, each (K, r, model, logLik, BIC).}
}
\description{
This function tries all combinations of K in Kvec and r in rvec,
fits a Mixture Factor Analysis (MFA) model using mfa_em_fit
for each combination, computes BIC, and returns the best model by BIC.
}
\details{
- Calls mfa_em_fit(..., n_init, use_kmeans_init, ...) for each (K, r).
- After fitting, we compute log-likelihood by summing over all data
  (you can use the built-in logLik from the fit, or re-compute).
- Then compute BIC = -2*logLik + p*log(N_total_rows).
  Here p = K*(M*r + 2*M) + (K - 1) by default (diagonal noise).
}
