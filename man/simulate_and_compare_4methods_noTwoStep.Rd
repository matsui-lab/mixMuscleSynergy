% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation_comparison.R
\name{simulate_and_compare_4methods_noTwoStep}
\alias{simulate_and_compare_4methods_noTwoStep}
\title{Simulate and Compare 4 Methods (SingleFA, SinglePCA, MixtureFA, MixturePCA) + VAF}
\usage{
simulate_and_compare_4methods_noTwoStep(
  N = 50,
  K_true = 2,
  r_true = 2,
  M = 6,
  T_each = 100,
  seed = 123,
  r_singleFA = 2,
  r_singlePCA = 2,
  cluster_sep = 1,
  noise_scale = 1,
  n_init = 1,
  use_kmeans_init = FALSE,
  subject_rdim_for_kmeans = r_true,
  mc_cores = 1,
  method_pca = "EM"
)
}
\arguments{
\item{N, K_true, r_true}{See \code{\link{simulate_mixture_data_for_comparison}}.}

\item{M}{Number of channels.}

\item{T_each}{Time-series length per subject.}

\item{seed}{Random seed.}

\item{r_singleFA}{Factor dimension for the single-factor-analysis approach.}

\item{r_singlePCA}{Number of principal components for single-PCA approach.}

\item{cluster_sep}{Numeric scalar that controls how far to separate cluster means
(passed to \code{\link{simulate_mixture_data_for_comparison}}).}

\item{noise_scale}{Numeric scalar that scales the noise diagonal in \eqn{\Psi_k}
(passed to \code{\link{simulate_mixture_data_for_comparison}}).}

\item{n_init}{Number of random initial assignments for mixture FA/PCA.
Defaults to \code{1} (the original single-run behavior).}

\item{use_kmeans_init}{Logical; if \code{TRUE}, also try a k-means-based initialization.
Defaults to \code{FALSE}.}

\item{subject_rdim_for_kmeans}{PCA dimension for subject-level features in k-means init,
defaults to \code{r_true} (the same factor dimension used in mixture).}

\item{mc_cores}{Number of cores for parallel runs (passed to \code{mclapply}). Default is 1.}

\item{method_pca}{Either \code{"EM"} or \code{"closed_form"} for the mixture PCA approach.
Defaults to \code{"EM"}.}
}
\value{
A data frame with columns: \code{Method, BIC, ARI, SSE, VAF}.
}
\description{
This function simulates data from a factor-based mixture (using
\code{\link{simulate_mixture_data_for_comparison}}). Then it fits:
\enumerate{
  \item Single FA (ignoring clusters)
  \item Single PCA (ignoring clusters)
  \item Mixture FA
  \item Mixture PCA
}
It computes BIC, ARI (for the mixture methods), reconstruction error (SSE),
**and** VAF (Variance Accounted For).
}
\details{
\itemize{
  \item The single approaches do not produce a cluster assignment, so \code{ARI=NA}.
  \item Mixture FA/PCA produce a hard assignment \code{z} that can be compared to the
        true \code{z_true}, yielding a meaningful ARI.
  \item SSE is computed by reconstructing each subject's data with the fitted model.
  \item VAF is defined as \code{1 - SSE / totalSST}, where totalSST is computed
        by \code{\link{calc_total_SST}} across all data.
}

If you set \code{n_init > 1} or \code{use_kmeans_init=TRUE}, the mixture FA/PCA
calls will attempt multiple initial assignments (including possibly a k-means-based one)
and pick the best final solution by log-likelihood. If you keep \code{n_init=1}
and \code{use_kmeans_init=FALSE}, it falls back to the original single-run approach.
}
\examples{
\dontrun{
df_comp <- simulate_and_compare_4methods_noTwoStep(
  N=100, K_true=3, r_true=4, M=6, T_each=100, seed=123,
  r_singleFA=4, r_singlePCA=4,
  cluster_sep=1.0, noise_scale=1.0,
  n_init=5, use_kmeans_init=TRUE, mc_cores=2
)
print(df_comp)
}

}
