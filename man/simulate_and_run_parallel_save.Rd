% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation_parameters.R
\name{simulate_and_run_parallel_save}
\alias{simulate_and_run_parallel_save}
\title{Run Simulation (MFA & MPCA) in Parallel, Saving Each Condition Separately}
\usage{
simulate_and_run_parallel_save(
  K_true_vec = c(3, 4),
  r_true_vec = c(3, 5),
  N_vec = c(50),
  M_vec = c(8, 12),
  T_each = 100,
  sep_vec = c(0.5, 1),
  noise_vec = c(1, 2),
  K_candidates = 1:5,
  r_candidates = 1:5,
  max_iter = 30,
  n_rep_init = 5,
  seed_data_base = 2023,
  mc.cores = parallel::detectCores() - 1,
  output_dir = "results",
  nIterFA = 20,
  nIterPCA = 20,
  tol = 0.001,
  method_pca = "EM"
)
}
\arguments{
\item{K_true_vec}{Vector of true K values to simulate.}

\item{r_true_vec}{Vector of true r values to simulate.}

\item{N_vec}{Vector of subject counts.}

\item{M_vec}{Vector of channel counts.}

\item{T_each}{Time-series length.}

\item{sep_vec}{Vector of separation parameters.}

\item{noise_vec}{Vector of noise scale parameters.}

\item{K_candidates}{Vector of candidate K values to try.}

\item{r_candidates}{Vector of candidate r values to try.}

\item{max_iter}{Max iteration for EM.}

\item{n_rep_init}{Number of random initial seeds for each (K,r) in search (used as `n_init` in new `mfa_em_fit`).}

\item{seed_data_base}{Base seed for data simulation.}

\item{mc.cores}{Number of parallel cores to use.}

\item{output_dir}{Directory to save each result as \code{result_K{...}_r{...}...rds}.}

\item{nIterFA}{Number of sub-iterations for the factor analyzer update in C++ (passed to `mfa_em_fit`).}

\item{tol}{Convergence tolerance for `mfa_em_fit`.}

\item{method_pca}{Which method for mpcaTimeseriesCpp ("EM" or "closed_form").}
}
\value{
A data frame with columns:
\item{K_true, r_true, N, M, sep, noise}{True simulation parameters.}
\item{ARI_MFA, BIC_MFA, Khat_MFA, rhat_MFA, ARI_PCA, BIC_PCA, Khat_PCA, rhat_PCA}{Results.}
}
\description{
Run Simulation (MFA & MPCA) in Parallel, Saving Each Condition Separately
}
