% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rotation.R
\name{rotate_mpca_model}
\alias{rotate_mpca_model}
\title{Post-hoc Rotation for a Mixture PCA Model}
\usage{
rotate_mpca_model(
  mpca_fit,
  rotation = c("varimax"),
  rotate_scores = FALSE,
  cluster_ids = NULL
)
}
\arguments{
\item{mpca_fit}{A fitted MPCA model, e.g. returned by \code{mixture_pca_em_fit()}
or \code{select_optimal_K_r_mpca()$best_model_info$model}, typically containing:
\itemize{
  \item \code{W[[k]]}: (M x r) loadings for cluster k
  \item \code{factor_scores[[i]]}: optional (T_i x r) PC scores for subject i
  \item \code{z[i]}: cluster assignments
}}

\item{rotation}{Rotation method, e.g. \code{"varimax"}.}

\item{rotate_scores}{Logical; if TRUE, also rotate factor_scores if present.}

\item{cluster_ids}{Vector of cluster indices to rotate. Defaults to all.}
}
\value{
A new MPCA model object with \code{W[[k]]} rotated, and \code{factor_scores}
also rotated if requested and available.
}
\description{
Applies a chosen rotation (e.g. varimax) to each cluster's loading matrix \code{W[[k]]}
in a fitted MPCA model, optionally also rotating the subject factor scores
in \code{factor_scores[[i]]}.
}
\details{
In R's \code{stats::varimax()}, the matrix should have rows = variables, cols = factors.
If \code{W_k} is already \code{(M x r)}, then passing it directly to varimax means
we have M variables, r factors. The returned rotation matrix is \code{(r x r)}, and
\code{scores_i (T_i x r)} can be multiplied by that.
}
