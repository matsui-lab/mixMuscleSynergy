% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rotation.R
\name{compute_factor_scores_mpca}
\alias{compute_factor_scores_mpca}
\title{Compute PC Factor Scores for All Subjects in a Mixture PCA Model}
\usage{
compute_factor_scores_mpca(mpca_fit, list_of_data)
}
\arguments{
\item{mpca_fit}{A fitted MPCA model from \code{mixture_pca_em_fit()} or
\code{select_optimal_K_r_mpca()$best_model_info$model}, typically containing:
\itemize{
  \item \code{z[i]}: cluster assignments (1..K),
  \item \code{mu[[k]]}, \code{W[[k]]}, \code{sigma2[k]} for each cluster,
  \item possibly \code{P[[k]], D[[k]]} instead of \code{W[[k]]}.
}}

\item{list_of_data}{The same list of data \code{(T_i x M)} used to fit the model.}
}
\value{
The same \code{mpca_fit} object, but with a new element \code{factor_scores},
  where \code{factor_scores[[i]]} is a \code{(T_i x r)} matrix of PC scores for subject \code{i}.
}
\description{
Given a fitted MPCA model (with \code{z, mu, W, sigma2} for each cluster),
this function computes the posterior factor (PC) scores \code{Z_i(t)} for each subject \code{i}
and stores them in \code{mpca_fit$factor_scores[[i]]}.
}
\details{
We use \code{\link{compute_factor_scores_mpca_single}} for each subject, with the
appropriate cluster parameters. This assumes isotropic noise \code{sigma2[k]} for cluster k.
}
\examples{
\dontrun{
mpca_fit <- compute_factor_scores_mpca(mpca_fit, list_of_data)
mpca_fit$factor_scores[[1]]  # (T_1 x r) PC scores
}
}
