% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rotation.R
\name{compute_factor_scores_mpca_single}
\alias{compute_factor_scores_mpca_single}
\title{Compute Factor (PC) Scores for a Single Subject in a Mixture PCA Cluster}
\usage{
compute_factor_scores_mpca_single(X, mu, W, sigma2)
}
\arguments{
\item{X}{A (T x M) data matrix for one subject/time-series.}

\item{mu}{A length-M mean vector.}

\item{W}{An (M x r) loading (projection) matrix for the cluster.}

\item{sigma2}{A scalar representing isotropic noise variance (sigma^2).}
}
\value{
A (T x r) matrix of factor (PC) scores for this subject.
}
\description{
Given a single subject's data X, and the cluster parameters (mu, W, sigma2),
this function computes the posterior factor scores (T x r) under a PPCA assumption
with isotropic noise sigma^2 * I.
}
\details{
We use the posterior mean formula for PPCA with isotropic noise:
\deqn{
  z(t) = (W^\top W + \sigma^2 I_r)^{-1} \, W^\top [ x(t) - \mu ].
}
This is applied row by row in X, but we can do it in a vectorized manner.

If your noise model is not purely \sigma^2 I, you will need a more general approach.
Also note that if T=1, the result might be a (1 x r) matrix or (r)-vector, so
be sure to keep it as a matrix if desired.
}
